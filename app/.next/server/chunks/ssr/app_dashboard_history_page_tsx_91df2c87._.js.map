{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/WeIntern%20Work/AI%20Generator/ai-generator-kbs/app/dashboard/history/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from 'react';\r\nimport { useUser } from '@clerk/nextjs';\r\nimport { db } from '@/utils/db';\r\nimport { AIOutput } from '@/utils/schema';\r\nimport { eq, desc } from 'drizzle-orm';  // Add desc to handle sorting\r\n\r\nconst HistoryPage = () => {\r\n  const { user } = useUser();\r\n  const [history, setHistory] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n\r\n  useEffect(() => {\r\n    const fetchHistory = async () => {\r\n      if (!user?.primaryEmailAddress?.emailAddress) return;\r\n\r\n      try {\r\n        const results = await db\r\n          .select()\r\n          .from(AIOutput)\r\n          .where(eq(AIOutput.createdBy, user.primaryEmailAddress.emailAddress))\r\n          .orderBy(desc(AIOutput.createdAt)); // Correct way to use desc in drizzle-orm\r\n\r\n        setHistory(results);\r\n      } catch (error) {\r\n        console.error('Error fetching history:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchHistory();\r\n  }, [user]);\r\n\r\n  return (\r\n    <div className=\"p-10 bg-gray-100\">\r\n      <div className='bg-white flex rounded-lg flex-col p-5'>\r\n        <h1 className=\"text-2xl font-extrabold p-4\">History</h1>\r\n        <p className='text-l p-4 mt-[-20px]'>Search your previously generated AI content.</p>\r\n\r\n        {loading ? (\r\n          <div>Loading...</div>\r\n        ) : (\r\n          <div className=\"space-y-5\">\r\n            {history.length === 0 ? (\r\n              <div>No history found.</div>\r\n            ) : (\r\n              history.map((entry, index) => (\r\n                <div key={index} className=\"border p-4 rounded-lg shadow-sm \">\r\n                  <div className=\"font-semibold flex justify-between\">\r\n                    Template: {entry.templateSlug}\r\n                    <span>Word Count: {entry?.aiResponse ? entry.aiResponse.trim().split(/\\s+/).length : 0}</span>\r\n                  </div>\r\n                  <div className=\"mt-2\">{JSON.parse(entry.formData).description}</div>\r\n                  <div className=\"mt-2\">AI Response: {entry.aiResponse}</div>\r\n\r\n                  <div className=\"mt-2 text-sm text-gray-500\">Created At: {entry.createdAt}</div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HistoryPage;\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AACA,6RAAyC,6BAA6B;AAAtE;AALA;;;;;;;AAOA,MAAM,cAAc;IAClB,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,iMAAA,CAAA,UAAO,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,EAAE;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAW;IAEhD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,eAAe;YACnB,IAAI,CAAC,MAAM,qBAAqB,cAAc;YAE9C,IAAI;gBACF,MAAM,UAAU,MAAM,4GAAA,CAAA,KAAE,CACrB,MAAM,GACN,IAAI,CAAC,gHAAA,CAAA,WAAQ,EACb,KAAK,CAAC,CAAA,GAAA,kKAAA,CAAA,KAAE,AAAD,EAAE,gHAAA,CAAA,WAAQ,CAAC,SAAS,EAAE,KAAK,mBAAmB,CAAC,YAAY,GAClE,OAAO,CAAC,CAAA,GAAA,8JAAA,CAAA,OAAI,AAAD,EAAE,gHAAA,CAAA,WAAQ,CAAC,SAAS,IAAI,yCAAyC;gBAE/E,WAAW;YACb,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;YAC3C,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;KAAK;IAET,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA8B;;;;;;8BAC5C,8OAAC;oBAAE,WAAU;8BAAwB;;;;;;gBAEpC,wBACC,8OAAC;8BAAI;;;;;yCAEL,8OAAC;oBAAI,WAAU;8BACZ,QAAQ,MAAM,KAAK,kBAClB,8OAAC;kCAAI;;;;;+BAEL,QAAQ,GAAG,CAAC,CAAC,OAAO,sBAClB,8OAAC;4BAAgB,WAAU;;8CACzB,8OAAC;oCAAI,WAAU;;wCAAqC;wCACvC,MAAM,YAAY;sDAC7B,8OAAC;;gDAAK;gDAAa,OAAO,aAAa,MAAM,UAAU,CAAC,IAAI,GAAG,KAAK,CAAC,OAAO,MAAM,GAAG;;;;;;;;;;;;;8CAEvF,8OAAC;oCAAI,WAAU;8CAAQ,KAAK,KAAK,CAAC,MAAM,QAAQ,EAAE,WAAW;;;;;;8CAC7D,8OAAC;oCAAI,WAAU;;wCAAO;wCAAc,MAAM,UAAU;;;;;;;8CAEpD,8OAAC;oCAAI,WAAU;;wCAA6B;wCAAa,MAAM,SAAS;;;;;;;;2BARhE;;;;;;;;;;;;;;;;;;;;;AAiB1B;uCAEe","debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}